<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Line Adventure</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://unpkg.com/ionicons@4.5.10-0/dist/css/ionicons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Colors - Dark Theme */
            --bg-primary: #121212;
            --bg-secondary: #1f1f1f;
            --bg-tertiary: #333333;
            --bg-gradient-dark: linear-gradient(145deg, #1e1e1e, #333333);
            --bg-input: #2c2c2c;
            --bg-profile: rgb(25, 25, 25);

            /* Text Colors - Dark Theme */
            --text-primary: #fff;
            --text-secondary: #ddd;
            --text-tertiary: #b0bec5;
            --text-muted: rgb(230, 230, 230);
            --text-light-gray: rgb(240, 240, 240);
            --text-dark-gray: rgb(220, 220, 220);

            /* Accent Colors */
            --accent-primary: #ffc107;
            --accent-hover: #e0a800;
            --accent-focus: #ffd54f;
            --accent-button-text: black;

            /* Logout button specific â€” remain same for light and dark themes */
            --logout-bg: #e53935;
            --logout-text: #fff;
            --logout-hover: #d32f2f;

            /* Status Colors */
            --error-color: #FF3333;
            --error-bg: #e53935;
            --error-hover: #d32f2f;

            /* Overlay Colors */
            --overlay-bg: rgba(0, 0, 0, 0.5);
            --loading-overlay-bg: black;
            --loading-credits-color: rgb(245, 245, 245);

            /* Scrollbar Colors */
            --scrollbar-thumb: rgb(50, 50, 50);
            --scrollbar-track: transparent;

            /* Shadow Colors */
            --shadow-dark: rgba(0, 0, 0, 0.5);
            --shadow-medium: rgba(0, 0, 0, 0.6);
            --shadow-light: rgba(0, 0, 0, 0.4);

            /* Spacing Values */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 12px;
            --spacing-lg: 16px;
            --spacing-xl: 20px;
            --spacing-xxl: 25px;
            --spacing-xxxl: 30px;

            /* Border Radius */
            --radius-sm: 5px;
            --radius-md: 8px;
            --radius-lg: 10px;
            --radius-xl: 12px;
            --radius-full: 50%;

            /* Font Sizes */
            --font-sm: 0.9rem;
            --font-base: 1rem;
            --font-md: 1.1rem;
            --font-lg: 1.2rem;
            --font-xl: 1.6rem;
            --font-xxl: 1.7rem;
            --font-xxxl: 1.8rem;
            --font-icon-sm: 1.2rem;
            --font-icon-md: 1.8rem;
            --font-icon-lg: 2.1rem;
            --font-icon-xl: 64px;

            /* Transitions */
            --transition-fast: 0.2s ease;
            --transition-base: 0.3s ease;
            --transition-slow: 0.4s all;
            --transition-slower: 0.5s;

            /* Z-index */
            --z-overlay: 1;
            --z-header: 10;
            --z-sidebar: 20;
            --z-signin: 99999;
            --z-loading: 500000;

            /* Dimensions */
            --sidebar-width: 260px;
            --avatar-sm: 40px;
            --avatar-md: 70px;
            --avatar-lg: 80px;
            --scrollbar-width: 6px;
        }

        /* Light theme overrides */
        body.light-theme {
            --bg-primary: #ffffff;
            --bg-secondary: rgb(253, 253, 253);
            --bg-tertiary: rgb(240, 240, 240);
            --bg-gradient-dark: linear-gradient(145deg, #ffffff, #f0f0f0);
            --bg-input: #ffffff;
            --bg-profile: rgb(253, 253, 253);

            --text-primary: #333;
            --text-secondary: rgb(50, 50, 50);
            --text-tertiary: rgb(80, 80, 80);
            --text-muted: #333;
            --text-light-gray: rgb(50, 50, 50);
            --text-dark-gray: rgb(90, 90, 90);

            --accent-button-text: rgb(30, 30, 30);

            --error-color: #d32f2f;
            --error-bg: #ff6666;
            --error-hover: #ff4d4d;

            --loading-overlay-bg: rgb(253, 253, 253);
            --loading-credits-color: rgb(50, 50, 50);

            --scrollbar-thumb: rgb(170, 170, 170);

            --shadow-dark: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.1);
            --shadow-light: rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', sans-serif;
            max-height: 999999px;
            transition: var(--transition-base) all;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: var(--spacing-xl);
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            display: none;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xxxl);
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }

        .title {
            font-size: var(--font-xxl);
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .theme-toggle {
            background: var(--bg-secondary);
            border: none;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--radius-lg);
            cursor: pointer;
            color: var(--text-primary);
            font-size: var(--font-base);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            box-shadow: 0 2px 8px var(--shadow-light);
        }

        .theme-toggle:hover {
            background: var(--bg-tertiary);
        }

        .game-area {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xxxl);
            box-shadow: 0 4px 20px var(--shadow-medium);
            margin-bottom: var(--spacing-xl);
        }

        .score-board {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xxl);
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }

        .score-item {
            background: var(--bg-tertiary);
            padding: var(--spacing-md) var(--spacing-xl);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            font-size: var(--font-md);
            font-weight: 700;
        }

        .score-value {
            color: var(--accent-primary);
            font-size: var(--font-xl);
        }

        .question-area {
            background: var(--bg-gradient-dark);
            padding: var(--spacing-xxl);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-xxl);
            text-align: center;
        }

        .question {
            font-size: var(--font-xl);
            color: var(--text-primary);
            margin-bottom: var(--spacing-lg);
            font-weight: 500;
        }

        .number-line-container {
            position: relative;
            padding: 60px 40px;
            margin: var(--spacing-xxl) 0;
            overflow-x: auto;
            overflow-y: visible;
        }

        .number-line {
            position: relative;
            height: 4px;
            background: var(--accent-primary);
            border-radius: var(--radius-sm);
            margin: 0 auto;
            min-width: 600px;
        }

        .tick {
            position: absolute;
            width: 2px;
            height: 20px;
            background: var(--accent-primary);
            top: -8px;
        }

        .tick-label {
            position: absolute;
            top: 25px;
            transform: translateX(-50%);
            font-size: var(--font-base);
            color: var(--text-secondary);
            font-weight: 700;
        }

        .marker {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: var(--font-md);
            cursor: pointer;
            top: -18px;
            transform: translateX(-50%);
            box-shadow: 0 4px 12px var(--shadow-dark);
            transition: transform var(--transition-fast), box-shadow var(--transition-fast);
            user-select: none;
        }

        .marker:hover {
            transform: translateX(-50%) scale(1.1);
            box-shadow: 0 6px 16px var(--shadow-medium);
        }

        .marker.dragging {
            cursor: grabbing;
            transform: translateX(-50%) scale(1.2);
            z-index: 100;
        }

        .marker.player {
            background: #4CAF50;
            color: white;
        }

        .marker.target {
            background: var(--accent-primary);
            color: var(--accent-button-text);
        }

        .marker.static {
            background: #2196F3;
            color: white;
            cursor: default;
        }

        .marker.static:hover {
            transform: translateX(-50%);
        }

        /*.drop-zone {
            position: absolute;
            width: 50px;
            height: 50px;
            border: 3px dashed var(--accent-primary);
            border-radius: var(--radius-full);
            top: -23px;
            transform: translateX(-50%);
            background: var(--bg-tertiary);
            opacity: 0.5;
            transition: all var(--transition-fast);
        }*/

        .drop-zone.active {
            opacity: 1;
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: var(--spacing-lg);
            flex-wrap: wrap;
            margin-top: var(--spacing-xxl);
        }

        .btn {
            background: var(--accent-primary);
            color: var(--accent-button-text);
            border: none;
            padding: var(--spacing-md) var(--spacing-xxl);
            border-radius: var(--radius-lg);
            font-size: var(--font-base);
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            box-shadow: 0 2px 8px var(--shadow-light);
            transition: all var(--transition-fast);
        }

        .btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-input);
        }

        .feedback {
            text-align: center;
            font-size: var(--font-xl);
            font-weight: 700;
            margin-top: var(--spacing-xl);
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-md);
        }

        .feedback.correct {
            color: #4CAF50;
        }

        .feedback.incorrect {
            color: var(--error-color);
        }

        .animation-celebrate {
            animation: celebrate 0.6s ease;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.1) rotate(5deg); }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--accent-primary);
            position: absolute; /* This overrides fixed */
            animation: confetti-fall 1s ease-out forwards;
            z-index: 10000;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .instructions {
            background: var(--bg-tertiary);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            margin-top: var(--spacing-xl);
            border-left: 4px solid var(--accent-primary);
        }

        .instructions h3 {
            color: var(--accent-primary);
            margin-bottom: var(--spacing-sm);
            font-size: var(--font-lg);
        }

        .instructions p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            body {
                padding: var(--spacing-md);
            }

            .game-area {
                padding: var(--spacing-lg);
            }

            .question-area {
                padding: var(--spacing-lg);
            }

            .title {
                font-size: var(--font-xl);
            }

            .number-line-container {
                padding: 40px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">
                <i class="fas fa-ruler-horizontal"></i>
                Number Line Adventure
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">
                <i class="fas fa-moon"></i>
                <span id="theme-text">Light Mode</span>
            </button>
        </div>

        <div class="game-area">
            <div class="score-board">
                <div class="score-item">
                    <i class="fas fa-star"></i>
                    <span>Score: <span class="score-value" id="score">0</span></span>
                </div>
                <div class="score-item">
                    <i class="fas fa-trophy"></i>
                    <span>Level: <span class="score-value" id="level">1</span></span>
                </div>
                <div class="score-item" style="display: none">
                    <i class="fas fa-fire"></i>
                    <span>Streak: <span class="score-value" id="streak">0</span></span>
                </div>
            </div>

            <div class="question-area">
                <div class="question" id="question">Loading...</div>
            </div>

            <div class="number-line-container">
                <div class="number-line" id="numberLine"></div>
            </div>

            <div class="feedback" id="feedback"></div>

            <div class="controls">
                <button class="btn" onclick="checkAnswer()">
                    <i class="fas fa-check"></i>
                    Check Answer
                </button>
                <button class="btn btn-secondary" onclick="newQuestion()">
                    <i class="fas fa-forward"></i>
                    Next Question
                </button>
                <button class="btn btn-secondary" onclick="showHint()">
                    <i class="fas fa-lightbulb"></i>
                    Hint
                </button>
            </div>

            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> How to Play</h3>
                <p id="instructions">Drag the green marker to the correct position on the number line!</p>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            score: 0,
            level: 1,
            streak: 0,
            currentQuestion: null,
            playerPosition: 0,
            minNum: -5,  // CHANGED: Start with negative numbers
            maxNum: 5,   // CHANGED: Start with a smaller range
            answered: false
        };

        const questionTypes = [
            {
                type: 'locate',
                generate: (min, max) => {
                    const target = Math.floor(Math.random() * (max - min + 1)) + min;
                    return {
                        question: `Find the number ${target} on the number line!`,
                        answer: target,
                        instructions: 'Drag the green marker to the correct position on the number line!'
                    };
                }
            },
            {
                type: 'add',
                generate: (min, max) => {
                    // CHANGED: Robust logic for negative numbers
                    const add = Math.floor(Math.random() * 5) + 1; // Add 1 to 5
                    const start = Math.floor(Math.random() * (max - min - add + 1)) + min;
                    return {
                        question: `Start at ${start} and add ${add}. Where do you land?`,
                        answer: start + add,
                        startPosition: start,
                        instructions: 'Drag the green marker from the blue marker to find the answer!'
                    };
                }
            },
            {
                type: 'subtract',
                generate: (min, max) => {
                    // CHANGED: Robust logic for negative numbers
                    const subtract = Math.floor(Math.random() * 5) + 1; // Subtract 1 to 5
                    const start = Math.floor(Math.random() * (max - min - subtract + 1)) + min + subtract;
                    return {
                        question: `Start at ${start} and subtract ${subtract}. Where do you land?`,
                        answer: start - subtract,
                        startPosition: start,
                        instructions: 'Drag the green marker from the blue marker to find the answer!'
                    };
                }
            },
            {
                type: 'between',
                generate: (min, max) => {
                    const num1 = Math.floor(Math.random() * (max - min - 2)) + min;
                    const num2 = num1 + 2;
                    const answer = num1 + 1;
                    return {
                        question: `What number is between ${num1} and ${num2}?`,
                        answer: answer,
                        instructions: 'Drag the green marker to the number between the two shown!'
                    };
                }
            },
            {
                type: 'distance',
                generate: (min, max) => {
                    // CHANGED: Improved question type and logic
                    const distance = Math.floor(Math.random() * 4) + 2; // 2 to 5
                    // 50/50 chance of adding or subtracting
                    if (Math.random() > 0.5) {
                        // Add distance
                        const num1 = Math.floor(Math.random() * (max - min - distance + 1)) + min;
                        const answer = num1 + distance;
                        return {
                            question: `What is ${distance} steps to the RIGHT of ${num1}?`,
                            answer: answer,
                            startPosition: num1,
                            instructions: 'Drag the green marker to count the steps!'
                        };
                    } else {
                        // Subtract distance
                        const num1 = Math.floor(Math.random() * (max - min - distance + 1)) + min + distance;
                        const answer = num1 - distance;
                            return {
                            question: `What is ${distance} steps to the LEFT of ${num1}?`,
                            answer: answer,
                            startPosition: num1,
                            instructions: 'Drag the green marker to count the steps!'
                        };
                    }
                }
            }
        ];

        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const themeText = document.getElementById('theme-text');
            const icon = document.querySelector('.theme-toggle i');
            
            if (document.body.classList.contains('light-theme')) {
                themeText.textContent = 'Dark Mode';
                icon.className = 'fas fa-sun';
            } else {
                themeText.textContent = 'Light Mode';
                icon.className = 'fas fa-moon';
            }
        }

        function createNumberLine() {
            const numberLine = document.getElementById('numberLine');
            numberLine.innerHTML = '';
            
            const { minNum, maxNum } = gameState;
            const range = maxNum - minNum;
            
            // Create ticks and labels
            for (let i = minNum; i <= maxNum; i++) {
                const tick = document.createElement('div');
                tick.className = 'tick';
                const position = ((i - minNum) / range) * 100;
                tick.style.left = `${position}%`;
                
                const label = document.createElement('div');
                label.className = 'tick-label';
                label.textContent = i;
                label.style.left = `${position}%`;
                
                numberLine.appendChild(tick);
                numberLine.appendChild(label);
            }
            
            // Create drop zone if needed
            if (gameState.currentQuestion) {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone';
                dropZone.id = 'dropZone';
                const position = ((gameState.currentQuestion.answer - minNum) / range) * 100;
                dropZone.style.left = `${position}%`;
                numberLine.appendChild(dropZone);
            }
            
            // Create static marker if question has start position
            if (gameState.currentQuestion && gameState.currentQuestion.startPosition !== undefined) {
                const staticMarker = document.createElement('div');
                staticMarker.className = 'marker static';
                staticMarker.textContent = gameState.currentQuestion.startPosition;
                const position = ((gameState.currentQuestion.startPosition - minNum) / range) * 100;
                staticMarker.style.left = `${position}%`;
                numberLine.appendChild(staticMarker);
            }
            
            // Create player marker
            const playerMarker = document.createElement('div');
            playerMarker.className = 'marker player';
            playerMarker.id = 'playerMarker';
            playerMarker.textContent = '?';
            
            const startPos = gameState.currentQuestion?.startPosition ?? minNum;
            gameState.playerPosition = startPos;
            const position = ((startPos - minNum) / range) * 100;
            playerMarker.style.left = `${position}%`;
            
            // CHANGED: Replaced all drag/touch listeners with unified handlers
            playerMarker.addEventListener('mousedown', handlePointerDown);
            playerMarker.addEventListener('touchstart', handlePointerDown, { passive: false });
            
            numberLine.appendChild(playerMarker);
        }

        let isDragging = false;

        // NEW: Unified pointer down handler
        function handlePointerDown(e) {
            isDragging = true;
            document.getElementById('playerMarker').classList.add('dragging');

            // Add move/end listeners to the document for robust tracking
            document.addEventListener('mousemove', handlePointerMove);
            document.addEventListener('mouseup', handlePointerUp);
            document.addEventListener('touchmove', handlePointerMove, { passive: false });
            document.addEventListener('touchend', handlePointerUp);
            
            e.preventDefault(); // Prevent default text selection or page scroll
        }

        // NEW: Unified pointer move handler
        function handlePointerMove(e) {
            if (!isDragging) return;
            
            // Get the correct clientX for touch or mouse
            let clientX;
            if (e.type === 'touchmove') {
                clientX = e.touches[0].clientX;
                e.preventDefault(); // Prevent scrolling while dragging
            } else {
                clientX = e.clientX;
            }
            
            updateMarkerPosition(clientX);
        }

        // NEW: Unified pointer up handler
        function handlePointerUp(e) {
            if (!isDragging) return; // Prevent extra fires
            isDragging = false;
            
            const playerMarker = document.getElementById('playerMarker');
            if (playerMarker) {
                 playerMarker.classList.remove('dragging');
            }

            // Remove move/end listeners from the document
            document.removeEventListener('mousemove', handlePointerMove);
            document.removeEventListener('mouseup', handlePointerUp);
            document.removeEventListener('touchmove', handlePointerMove);
            document.removeEventListener('touchend', handlePointerUp);
            
            snapToNearestTick();
        }

        // REMOVED: handleDragStart, handleDrag, handleDragEnd
        // REMOVED: handleTouchStart, handleTouchMove, handleTouchEnd

        function updateMarkerPosition(clientX) {
            const numberLine = document.getElementById('numberLine');
            const rect = numberLine.getBoundingClientRect();
            const x = clientX - rect.left;
            const percentage = Math.max(0, Math.min(100, (x / rect.width) * 100));
            
            const playerMarker = document.getElementById('playerMarker');
            playerMarker.style.left = `${percentage}%`;
            
            // Update drop zone visual feedback
            const dropZone = document.getElementById('dropZone');
            if (dropZone) {
                const dropZoneLeft = parseFloat(dropZone.style.left);
                if (Math.abs(percentage - dropZoneLeft) < 5) {
                    dropZone.classList.add('active');
                } else {
                    dropZone.classList.remove('active');
                }
            }
        }

        function snapToNearestTick() {
            const { minNum, maxNum } = gameState;
            const range = maxNum - minNum;
            const playerMarker = document.getElementById('playerMarker');
            const currentLeft = parseFloat(playerMarker.style.left);
            
            const position = (currentLeft / 100) * range + minNum;
            const nearest = Math.round(position);
            gameState.playerPosition = nearest;
            
            const snappedPosition = ((nearest - minNum) / range) * 100;
            playerMarker.style.left = `${snappedPosition}%`;
            playerMarker.textContent = nearest;
        }

        function newQuestion() {
            gameState.answered = false;
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            
            // CHANGED: New difficulty scaling
            // Every 3 levels, expand the range by 5 in both directions
            const expansion = Math.floor((gameState.level - 1) / 3) * 5;
            gameState.minNum = -5 - expansion;
            gameState.maxNum = 5 + expansion;
            
            // REMOVED: Old difficulty logic
            
            const questionType = questionTypes[Math.floor(Math.random() * questionTypes.length)];
            gameState.currentQuestion = questionType.generate(gameState.minNum, gameState.maxNum);
            
            document.getElementById('question').textContent = gameState.currentQuestion.question;
            document.getElementById('instructions').textContent = gameState.currentQuestion.instructions;
            
            createNumberLine();
        }

        function checkAnswer() {
            if (gameState.answered) return;
            
            const feedback = document.getElementById('feedback');
            const correct = gameState.playerPosition === gameState.currentQuestion.answer;
            
            gameState.answered = true;
            
            if (correct) {
                gameState.score += 10 * gameState.level;
                gameState.streak++;
                
                if (gameState.streak % 3 === 0) {
                    gameState.level++;
                    document.getElementById('level').textContent = gameState.level;
                }
                
                feedback.innerHTML = '<i class="fas fa-check-circle"></i> Awesome! You got it right!';
                feedback.className = 'feedback correct animation-celebrate';
                
                createConfetti();
                
                setTimeout(() => {
                    newQuestion();
                }, 2000);
            } else {
                gameState.streak = 0;
                feedback.innerHTML = `<i class="fas fa-times-circle"></i> Not quite! The answer is ${gameState.currentQuestion.answer}`;
                feedback.className = 'feedback incorrect';
                
                // Show correct answer
                const { minNum, maxNum } = gameState;
                const range = maxNum - minNum;
                const correctPosition = ((gameState.currentQuestion.answer - minNum) / range) * 100;
                
                const targetMarker = document.createElement('div');
                targetMarker.className = 'marker target';
                targetMarker.textContent = gameState.currentQuestion.answer;
                targetMarker.style.left = `${correctPosition}%`;
                document.getElementById('numberLine').appendChild(targetMarker);
            }
            
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('streak').textContent = gameState.streak;
        }

        function showHint() {
            const { answer, startPosition } = gameState.currentQuestion;
            const { minNum, maxNum } = gameState;
            
            let hint = '';
            
            if (startPosition !== undefined) {
                const difference = answer - startPosition;
                hint = `The answer is ${Math.abs(difference)} steps ${difference > 0 ? 'to the right' : 'to the left'} from ${startPosition}`;
            } else if (answer < (minNum + maxNum) / 2) {
                hint = `The answer is closer to ${minNum}`;
            } else {
                hint = `The answer is closer to ${maxNum}`;
            }
            
            alert(hint);
        }

        function createConfetti() {
            const colors = ['#ffc107', '#4CAF50', '#2196F3', '#FF5722', '#9C27B0'];
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti'; // Set the class
                    
                    // Style the confetti
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = Math.random() * 100 + 'vw'; // Start at random horizontal viewport width
                    confetti.style.top = (Math.random() * -100) + 'px'; // Start above the viewport
                    confetti.style.width = (Math.random() * 5 + 5) + 'px';
                    confetti.style.height = (Math.random() * 10 + 10) + 'px';
                    confetti.style.opacity = Math.random() * 0.5 + 0.5;
                    
                    // The CSS animation 'confetti-fall 1s ease-out forwards' will be applied
                    
                    document.body.appendChild(confetti); // Append to body
                    
                    // Remove confetti after animation (1s)
                    setTimeout(() => {
                        confetti.remove();
                    }, 1000); 
                }, Math.random() * 500); // Stagger the confetti drop
            }
        }
        
        // Initialize the game
        document.addEventListener('DOMContentLoaded', () => {
            newQuestion();
        });
    </script>
</body>
</html>
